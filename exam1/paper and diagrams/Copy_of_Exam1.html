
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Copy_of_Exam1</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-10-10"><meta name="DC.source" content="Copy_of_Exam1.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput">clear <span class="string">all</span>;
close <span class="string">all</span>;
clc;

<span class="comment">%define the links</span>
l1 = 0;
l2 = 70
l3 = 100;

syms
<span class="comment">%go to home</span>
syms <span class="string">theta1</span> <span class="string">theta2</span> <span class="string">theta3</span>
links(1,:) = [ l1  degtorad(90) 0 degtorad(theta1)];
links(2,:) = [ l2 0 0 degtorad(theta2)];
links(3,:) = [ l3 0 0 degtorad(theta3- 90)];
<span class="comment">%get the A and T matrix</span>
A = getA(links);
T = getT(A);
</pre><pre class="codeoutput">
l2 =

    70

 
 
</pre><pre class="codeinput"><span class="comment">%Part 1</span>
<span class="comment">%Plot the work space</span>
T_fig =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ 0 0 0 ])));
<span class="comment">% x = T_fig(1,4,end);</span>
<span class="comment">% y = T_fig(2,4,end);</span>
<span class="comment">% z = T_fig(3,4,end);</span>
<span class="comment">%</span>
<span class="comment">% for t1 =  -90:20:90</span>
<span class="comment">%     for t2 =  -50:20:50</span>
<span class="comment">%         for t3 = 0-50:20:50</span>
<span class="comment">%             T_fig =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ t1 t2 t3 ])));</span>
<span class="comment">%             x = [x,T_fig(1,4,end)];</span>
<span class="comment">%             y = [y,T_fig(2,4,end)];</span>
<span class="comment">%             z = [z,T_fig(3,4,end)];</span>
<span class="comment">%         end</span>
<span class="comment">%     end</span>
<span class="comment">% end</span>
<span class="comment">%</span>
<span class="comment">% %plot the X-Y plane</span>
<span class="comment">% figure(1);</span>
<span class="comment">% plot(x,y,'r*')</span>
<span class="comment">% title('X-Y plane');</span>
<span class="comment">% xlabel('x (cm)');</span>
<span class="comment">% ylabel('y (cm)');</span>
<span class="comment">%</span>
<span class="comment">% %plot the X-Z plane</span>
<span class="comment">% figure(2);</span>
<span class="comment">% plot(x,z,'r*')</span>
<span class="comment">% title('X-Z plane');</span>
<span class="comment">% xlabel('x (mm)');</span>
<span class="comment">% ylabel('z (mm)');</span>
</pre><pre class="codeinput"><span class="comment">%plot the arm</span>
<span class="comment">%Part 3</span>
</pre><p><img src="Copy_of_Exam1_eq08025411081987005357.png" alt="$$\left[\begin{array}{cccc} a &amp; alpha &amp; d &amp; theta \\ 0 &amp; \frac{\pi}{2} &amp; 0 &amp; \frac{\pi\, \mathrm{theta1}}{180}\\ 70 &amp; 0 &amp; 0 &amp; \frac{\pi\, \mathrm{theta2}}{180}\\ 100 &amp; 0 &amp; 0 &amp; \frac{\pi\, \left(\mathrm{theta3} - 90\right)}{180} \end{array}\right]$$"></p><pre class="codeinput"><span class="comment">%Part 4</span>
<span class="comment">%The transforms are:</span>
T
</pre><pre class="codeoutput"> 
T(:,:,1) =
 
[ cos((pi*theta1)/180), 0,  sin((pi*theta1)/180), 0]
[ sin((pi*theta1)/180), 0, -cos((pi*theta1)/180), 0]
[                    0, 1,                     0, 0]
[                    0, 0,                     0, 1]
 
 
T(:,:,2) =
 
[ cos((pi*theta1)/180)*cos((pi*theta2)/180), -cos((pi*theta1)/180)*sin((pi*theta2)/180),  sin((pi*theta1)/180), 70*cos((pi*theta1)/180)*cos((pi*theta2)/180)]
[ cos((pi*theta2)/180)*sin((pi*theta1)/180), -sin((pi*theta1)/180)*sin((pi*theta2)/180), -cos((pi*theta1)/180), 70*cos((pi*theta2)/180)*sin((pi*theta1)/180)]
[                      sin((pi*theta2)/180),                       cos((pi*theta2)/180),                     0,                      70*sin((pi*theta2)/180)]
[                                         0,                                          0,                     0,                                            1]
 
 
T(:,:,3) =
 
[ cos((pi*theta1)/180)*cos((pi*theta2)/180)*cos((pi*(theta3 - 90))/180) - cos((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180), - cos((pi*theta1)/180)*cos((pi*theta2)/180)*sin((pi*(theta3 - 90))/180) - cos((pi*theta1)/180)*sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180),  sin((pi*theta1)/180), 70*cos((pi*theta1)/180)*cos((pi*theta2)/180) + 100*cos((pi*theta1)/180)*cos((pi*theta2)/180)*cos((pi*(theta3 - 90))/180) - 100*cos((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180)]
[ cos((pi*theta2)/180)*sin((pi*theta1)/180)*cos((pi*(theta3 - 90))/180) - sin((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180), - cos((pi*theta2)/180)*sin((pi*theta1)/180)*sin((pi*(theta3 - 90))/180) - sin((pi*theta1)/180)*sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180), -cos((pi*theta1)/180), 70*cos((pi*theta2)/180)*sin((pi*theta1)/180) + 100*cos((pi*theta2)/180)*sin((pi*theta1)/180)*cos((pi*(theta3 - 90))/180) - 100*sin((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180)]
[                                           cos((pi*theta2)/180)*sin((pi*(theta3 - 90))/180) + sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180),                                             cos((pi*theta2)/180)*cos((pi*(theta3 - 90))/180) - sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180),                     0,                                                                70*sin((pi*theta2)/180) + 100*cos((pi*theta2)/180)*sin((pi*(theta3 - 90))/180) + 100*sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180)]
[                                                                                                                                             0,                                                                                                                                               0,                     0,                                                                                                                                                                                                    1]
 
</pre><pre class="codeinput"><span class="comment">%Part 5</span>
T_fig =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ 0 0 0 ])));
figure(3);
plotArm(T_fig);
title(<span class="string">'Home'</span>)
xlabel(<span class="string">'x (mm)'</span>);
ylabel(<span class="string">'y (mm)'</span>);
</pre><img vspace="5" hspace="5" src="Copy_of_Exam1_01.png" alt=""> <pre class="codeinput"><span class="comment">%Part 6</span>
f = [0 0 10]
P_f = [ f 1]'
inv(T_fig(:,:,end))
vector = inv(T_fig(:,:,end))*P_f ;
vector = vector(1:3)
</pre><pre class="codeoutput">
f =

     0     0    10


P_f =

     0
     0
    10
     1


ans =

     0     0    -1  -100
     1     0     0   -70
     0    -1     0     0
     0     0     0     1


vector =

  -110
   -70
     0

</pre><pre class="codeinput"><span class="comment">%Part 7</span>
<span class="comment">% the joints are going to be decoupled and solved geometericly</span>
<span class="comment">% the elbow "up" config is going to be used, the opposite will also work.</span>

<span class="comment">%Pose</span>
Px = 80;
Py = 0;
Pz = -100;

<span class="comment">%set up</span>
a1 = l2;
a2 = l3;
r =  (a1*a1 + a2*a2)

<span class="comment">%Answer</span>
t3_IK = -acosd( ( (Px*Px) + (Pz*Pz) - r)/(2*a1*a2))
t2_IK = atan2d(Pz,Px)-atan2d( (a2*sind(t3_IK)), (a1 + a2*cosd(t3_IK)))
t1_IK = atan2d(Py,Px)

<span class="comment">%Plot the arm in the inverse configuration</span>
figure(4);
T_IK =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ t1_IK t2_IK t3_IK ])));
<span class="comment">%get the A and T matrix</span>
plotArm(T_IK)
title([<span class="string">'inverse solution t1= '</span>  num2str(t1_IK) <span class="string">' t2= '</span> num2str(t2_IK) <span class="string">' t3= '</span> num2str(t3_IK)])
</pre><pre class="codeoutput">
r =

       14900


t3_IK =

  -83.8494


t2_IK =

   -0.4104


t1_IK =

     0

</pre><img vspace="5" hspace="5" src="Copy_of_Exam1_02.png" alt=""> <pre class="codeinput"><span class="comment">%Part 8</span>
<span class="comment">%calculate the Jacobian</span>
j1 = getRevJ( T(1:3,3,1), T(1:3,4,end),T(1:3,4,1));
j2 = getRevJ( T(1:3,3,2), T(1:3,4,end),T(1:3,4,2));
j3 = getRevJ( T(1:3,3,3), T(1:3,4,end),T(1:3,4,3));
J = [j1 j2 j3 ]
</pre><pre class="codeoutput"> 
J =
 
[                                                                                                                                                                                                                                                                                             -cos((pi*theta1)/180)*(70*sin((pi*theta2)/180) + 100*cos((pi*theta2)/180)*sin((pi*(theta3 - 90))/180) + 100*sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180)),                                                                                                                                                                                                                         -cos((pi*theta1)/180)*(100*cos((pi*theta2)/180)*sin((pi*(theta3 - 90))/180) + 100*sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180)),                     0]
[                                                                                                                                                                                                                                                                                             -sin((pi*theta1)/180)*(70*sin((pi*theta2)/180) + 100*cos((pi*theta2)/180)*sin((pi*(theta3 - 90))/180) + 100*sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180)),                                                                                                                                                                                                                         -sin((pi*theta1)/180)*(100*cos((pi*theta2)/180)*sin((pi*(theta3 - 90))/180) + 100*sin((pi*theta2)/180)*cos((pi*(theta3 - 90))/180)),                     0]
[ cos((pi*theta1)/180)*(70*cos((pi*theta1)/180)*cos((pi*theta2)/180) + 100*cos((pi*theta1)/180)*cos((pi*theta2)/180)*cos((pi*(theta3 - 90))/180) - 100*cos((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180)) + sin((pi*theta1)/180)*(70*cos((pi*theta2)/180)*sin((pi*theta1)/180) + 100*cos((pi*theta2)/180)*sin((pi*theta1)/180)*cos((pi*(theta3 - 90))/180) - 100*sin((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180)), cos((pi*theta1)/180)*(100*cos((pi*theta1)/180)*cos((pi*theta2)/180)*cos((pi*(theta3 - 90))/180) - 100*cos((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180)) + sin((pi*theta1)/180)*(100*cos((pi*theta2)/180)*sin((pi*theta1)/180)*cos((pi*(theta3 - 90))/180) - 100*sin((pi*theta1)/180)*sin((pi*theta2)/180)*sin((pi*(theta3 - 90))/180)),                     0]
[                                                                                                                                                                                                                                                                                                                                                                                                                                      sin((pi*theta1)/180),                                                                                                                                                                                                                                                                                                                                        sin((pi*theta1)/180),  sin((pi*theta1)/180)]
[                                                                                                                                                                                                                                                                                                                                                                                                                                     -cos((pi*theta1)/180),                                                                                                                                                                                                                                                                                                                                       -cos((pi*theta1)/180), -cos((pi*theta1)/180)]
[                                                                                                                                                                                                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                                                                                                                                                           0,                     0]
 
</pre><pre class="codeinput"><span class="comment">%Part 9</span>
<span class="comment">%Find the determinant of the Jacobian of matix,</span>

det(J(1:3,:))

<span class="comment">%Since the determinant is zero the are no sigularities</span>
</pre><pre class="codeoutput"> 
ans =
 
0
 
</pre><pre class="codeinput"><span class="comment">%Part10</span>
J_s = simplify(subs(J, [ theta1 theta2  theta3 ], [ 0 0 0 ]))
jV = J_s(1:3,:);
xdot = [ 0 0 10 0 0 0 ]';
pinv(J_s)
thetadot = pinv(J_s)*xdot
</pre><pre class="codeoutput"> 
J_s =
 
[ 100, 100,  0]
[   0,   0,  0]
[  70,   0,  0]
[   0,   0,  0]
[  -1,  -1, -1]
[   0,   0,  0]
 
 
ans =
 
[      0, 0,  1/70, 0,  0, 0]
[  1/100, 0, -1/70, 0,  0, 0]
[ -1/100, 0,     0, 0, -1, 0]
 
 
thetadot =
 
  1/7
 -1/7
    0
 
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
clear all;
close all;
clc;

%define the links
l1 = 0;
l2 = 70
l3 = 100;

syms 
%go to home
syms theta1 theta2 theta3 
links(1,:) = [ l1  degtorad(90) 0 degtorad(theta1)];
links(2,:) = [ l2 0 0 degtorad(theta2)];
links(3,:) = [ l3 0 0 degtorad(theta3- 90)];
%get the A and T matrix
A = getA(links);
T = getT(A);

%%
%Part 1
%Plot the work space
T_fig =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ 0 0 0 ])));
% x = T_fig(1,4,end);
% y = T_fig(2,4,end);
% z = T_fig(3,4,end);
% 
% for t1 =  -90:20:90
%     for t2 =  -50:20:50
%         for t3 = 0-50:20:50
%             T_fig =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ t1 t2 t3 ])));
%             x = [x,T_fig(1,4,end)];
%             y = [y,T_fig(2,4,end)];
%             z = [z,T_fig(3,4,end)];   
%         end
%     end
% end
% 
% %plot the X-Y plane
% figure(1);
% plot(x,y,'r*')
% title('X-Y plane');
% xlabel('x (cm)');
% ylabel('y (cm)');
% 
% %plot the X-Z plane
% figure(2);
% plot(x,z,'r*')
% title('X-Z plane');
% xlabel('x (mm)');
% ylabel('z (mm)');


%%
%plot the arm
%Part 3
%%
% 
%%
% 
% $$\left[\begin{array}{cccc} a & alpha & d & theta \\ 0 & \frac{\pi}{2} & 0 & \frac{\pi\, \mathrm{theta1}}{180}\\ 70 & 0 & 0 & \frac{\pi\, \mathrm{theta2}}{180}\\ 100 & 0 & 0 & \frac{\pi\, \left(\mathrm{theta3} - 90\right)}{180} \end{array}\right]$$
% 
 

%%
%Part 4
%The transforms are:
T
%%
%Part 5
T_fig =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ 0 0 0 ])));
figure(3);
plotArm(T_fig);
title('Home')
xlabel('x (mm)');
ylabel('y (mm)');
%%
%Part 6
f = [0 0 10]
P_f = [ f 1]'
inv(T_fig(:,:,end))
vector = inv(T_fig(:,:,end))*P_f ;
vector = vector(1:3)

%%
%Part 7
% the joints are going to be decoupled and solved geometericly 
% the elbow "up" config is going to be used, the opposite will also work. 

%Pose
Px = 80;
Py = 0;
Pz = -100;

%set up 
a1 = l2;
a2 = l3;
r =  (a1*a1 + a2*a2)

%Answer
t3_IK = -acosd( ( (Px*Px) + (Pz*Pz) - r)/(2*a1*a2)) 
t2_IK = atan2d(Pz,Px)-atan2d( (a2*sind(t3_IK)), (a1 + a2*cosd(t3_IK)))
t1_IK = atan2d(Py,Px)

%Plot the arm in the inverse configuration
figure(4);
T_IK =  double(simplify(subs(T, [ theta1 theta2  theta3 ], [ t1_IK t2_IK t3_IK ])));
%get the A and T matrix
plotArm(T_IK)
title(['inverse solution t1= '  num2str(t1_IK) ' t2= ' num2str(t2_IK) ' t3= ' num2str(t3_IK)]) 

%%

%Part 8
%calculate the Jacobian
j1 = getRevJ( T(1:3,3,1), T(1:3,4,end),T(1:3,4,1));
j2 = getRevJ( T(1:3,3,2), T(1:3,4,end),T(1:3,4,2));
j3 = getRevJ( T(1:3,3,3), T(1:3,4,end),T(1:3,4,3));
J = [j1 j2 j3 ] 

%%
%Part 9
%Find the determinant of the Jacobian of matix, 

det(J(1:3,:))

%Since the determinant is zero the are no sigularities
%%
%Part10
J_s = simplify(subs(J, [ theta1 theta2  theta3 ], [ 0 0 0 ]))
jV = J_s(1:3,:);
xdot = [ 0 0 10 0 0 0 ]';
pinv(J_s)
thetadot = pinv(J_s)*xdot
%%


##### SOURCE END #####
--></body></html>